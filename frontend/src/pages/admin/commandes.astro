---
import Layout from "@layouts/Layout.astro";

const orders = await fetch("/api/admin/orders", { credentials: "include" })
  .then(res => res.json())
  .catch(() => []);
---

<Layout title="Commandes">
  <main class="p-4">
    <h1 class="text-2xl font-bold text-bleu mb-4">Toutes les commandes</h1>
    <ul class="space-y-4">
      {orders.map(order => (
        <li class="border rounded p-4 bg-white shadow">
          <p><strong>Commande ID:</strong> {order.id}</p>
          <p><strong>Utilisateur:</strong> {order.user_id}</p>
          <p><strong>Status:</strong> {order.status}</p>
          <p><strong>Date:</strong> {new Date(order.created_at).toLocaleString()}</p>
          <p><strong>Articles:</strong></p>
          <ul class="ml-4 list-disc">
            {order.items.map(item => (
              <li>{item.title} - {item.quantity} x {item.price} â‚¬</li>
            ))}
          </ul>
        </li>
      ))}
    </ul>
  </main>
</Layout>
